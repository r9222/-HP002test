<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>ãŸã¾ãƒ•ã‚£ãƒƒãƒˆPFC</title>
<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
<style>
/* â–¼â–¼â–¼ ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®š (ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãƒ»ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆç‰ˆ) â–¼â–¼â–¼ */
:root {
    --th: #f55a94;       /* ãƒ¡ã‚¤ãƒ³ãƒ”ãƒ³ã‚¯ */
    --bg: #fdf2f4;       /* èƒŒæ™¯ */
    --tx: #2d3436;       /* æ–‡å­—è‰²ï¼ˆå°‘ã—æ¿ƒãã—ã¦è¦–èªæ€§UPï¼‰ */
    --ac: #ffffff;       /* ã‚«ãƒ¼ãƒ‰èƒŒæ™¯ */
    --ma: #e6b422;       
    --mn: #ff9f43;       
    --sb: #f0f2f5;       
    --del: #ee5253;      
    --ed: #54a0ff;       
    --add: #1dd1a1;      
    --gd: #feca57;       
    --my: #a29bfe;       
    --body: #10ac84;     
    --alc: #9b59b6;      
}

body {
    font-family: 'M PLUS Rounded 1c', sans-serif;
    background: var(--bg);
    color: var(--tx);
    margin: 0;
    padding: 0 0 100px; /* ä¸‹éƒ¨ãƒœã‚¿ãƒ³åˆ†ã®ä½™ç™½ */
    line-height: 1.4;
    font-size: 14px;
    -webkit-tap-highlight-color: transparent;
}

/* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚¹ãƒªãƒ ã« */
.header {
    background: var(--th);
    padding: 8px 15px;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 1000;
}
.header h1 { 
    color: #fff; 
    font-size: 17px; 
    margin: 0; 
    font-weight: 700; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
}
.header h1 img { height: 28px !important; margin-right: 8px; border: 1px solid #fff; }

.container { max-width: 500px; margin: 0 auto; padding: 10px; }

/* ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã« */
.top-alert-box { 
    background: #fff; 
    border: 1px solid #ffc107; 
    padding: 10px; 
    border-radius: 10px; 
    margin-bottom: 12px; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.05); 
}
.ta-title { font-weight: 700; color: #d35400; font-size: 13px; margin-bottom: 5px; display: block; text-align: center; }
.ta-list { font-size: 11px; color: #555; display: none; } /* é‚ªé­”ãªã®ã§é€šå¸¸ã¯éš ã™ */
.ta-warn { font-size: 11px; color: var(--del); font-weight: 700; text-align: center; margin-bottom: 8px; }
.btn-import-huge { 
    display: block; width: 100%; background: #eee; color: #666; border: none; 
    padding: 8px; border-radius: 6px; font-size: 12px; font-weight: 700; cursor: pointer; 
}

/* ç›®æ¨™è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
.tgt-sec { background: #fff; padding: 8px; border-radius: 10px; margin-bottom: 10px; border: 1px solid #eee; }
.tgt-tog { font-weight: 700; color: var(--th); cursor: pointer; text-align: center; font-size: 13px; }
.tgt-btns { display: none; grid-template-columns: repeat(4, 1fr); gap: 4px; margin-top: 8px; }
.tg-btn { 
    padding: 6px 2px; border: 1px solid #f0f0f0; border-radius: 6px; font-size: 10px; 
    text-align: center; cursor: pointer; background: #fafafa; transition: 0.2s;
}
.tg-btn.act { background: var(--th); color: #fff; border-color: var(--th); box-shadow: 0 2px 4px rgba(245,90,148,0.3); }
.tg-btn strong { display: block; font-size: 12px; }

/* ãƒ¡ãƒ¼ã‚¿ãƒ¼UIã‚’ã‚¬ã‚¸ã‚§ãƒƒãƒˆé¢¨ã«ã‹ã£ã“ã‚ˆã */
.dash { 
    background: #fff; padding: 12px; border-radius: 12px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 15px; border: 1px solid #fce4ec; 
}
.dash-t { text-align: center; font-weight: 700; margin-bottom: 10px; color: var(--th); font-size: 12px; letter-spacing: 1px; }
.mtr { margin-bottom: 8px; }
.mtr-l { display: flex; justify-content: space-between; align-items: center; margin-bottom: 3px; }
.mtr-l .lbl span { font-size: 14px; font-weight: 700; color: #333; }
.mtr-l .lbl small { font-size: 9px; color: #999; margin-left: 5px; }
.rem { font-weight: 700; font-size: 12px; color: var(--th); }
.rem.ov { color: var(--del); }

.bar-bg { position: relative; height: 14px; background: #f0f0f0; border-radius: 7px; overflow: hidden; }
.bar { position: absolute; height: 100%; background: linear-gradient(90deg, #ff8bb5, var(--th)); width: 0%; transition: width 0.6s cubic-bezier(0.17, 0.67, 0.83, 0.67); border-radius: 7px; }
.bar.ov { background: linear-gradient(90deg, #ff7675, var(--del)); }
.bar-text { position: absolute; width: 100%; text-align: center; font-size: 9px; font-weight: 700; line-height: 14px; color: #fff; mix-blend-mode: difference; z-index: 2; }

/* å…¥åŠ›ã‚¨ãƒªã‚¢ã®å¼•ãç· ã‚ */
.inp-sec { background: #fff; padding: 12px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); margin-bottom: 15px; }
.s-box { margin-bottom: 10px; }
.s-inp { width: 100%; padding: 10px 10px 10px 35px; border-radius: 20px; border: 1px solid #eee; background: #f8f9fa; font-size: 14px; box-sizing: border-box; }
.s-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); font-size: 14px; }

.cat-grp { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; }
.c-btn { padding: 8px 4px; font-size: 12px; border: 1px solid #eee; background: #fff; color: #555; border-radius: 8px; cursor: pointer; font-weight: 700; }
.c-btn.act { background: var(--th); color: #fff; border-color: var(--th); }

/* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤ºï¼ˆä¸€ç•ªå¤§äº‹ï¼ï¼‰ */
.tl-sec { margin-bottom: 12px; }
.tl-head { 
    display: flex; justify-content: space-between; align-items: center; 
    padding: 6px 10px; background: rgba(255,255,255,0.8); border-radius: 8px; 
    margin-bottom: 5px; font-weight: 700; font-size: 12px; border-left: 3px solid var(--th);
}
.tl-stats { font-size: 10px; color: #888; font-weight: 400; }
.f-item { 
    background: #fff; padding: 8px 10px; border-radius: 8px; margin-bottom: 4px; 
    font-size: 13px; border: 1px solid #f0f0f0; display: flex; flex-direction: column;
}
.f-item strong { font-size: 13px; color: #333; }
.act-btns { display: flex; justify-content: flex-end; gap: 5px; margin-top: 5px; border-top: 1px solid #fafafa; padding-top: 5px; }
.l-btn { border: none; padding: 4px 10px; border-radius: 4px; font-size: 10px; font-weight: 700; color: #fff; }

/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ«ã®ã‚¹ãƒãƒ¼ãƒˆåŒ– */
.action-grid { 
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; 
    margin-top: 20px; margin-bottom: 10px; 
}
.action-tile { 
    background: #fff; border-radius: 12px; padding: 10px 5px; 
    border: 1px solid #f0f0f0; aspect-ratio: 1.1 / 1; 
}
.action-tile .icon { font-size: 20px; margin-bottom: 4px; }
.action-tile .label { font-size: 10px; font-weight: 700; color: #666; }

/* éŸ³å£°ãƒœã‚¿ãƒ³ã‚’æµ®ã‹ã›ã‚‹ */
#global-mic-btn { 
    position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); 
    background: linear-gradient(135deg, #ff4757, #ff6b81); color: #fff; 
    padding: 10px 25px; border-radius: 25px; box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4); 
    font-weight: 700; font-size: 14px; z-index: 9998; 
}

/* Myé£Ÿå“ãƒœã‚¿ãƒ³ç­‰ã®ã‚µãƒ–ãƒœã‚¿ãƒ³ */
.my-manual-btn { 
    display: block; width: 100%; padding: 8px; background: #eee; 
    color: #777; border: none; border-radius: 8px; font-size: 12px; 
    font-weight: 700; margin-top: 10px; 
}

/* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®éè¡¨ç¤ºï¼ˆiPhoneç”¨ï¼‰ */
::-webkit-scrollbar { display: none; }

/* è©³ç´°ç™»éŒ²ãƒœãƒ¼ãƒ‰ */
.reg-bd { border-radius: 12px; padding: 12px; }
.m-grid { gap: 8px; }
.m-grid input { padding: 6px; font-size: 14px; }
</style>
</head>
<body>

<div class="header">
    <h1><img src="tama_chara_mini.png" alt="ã‚­ãƒ£ãƒ©" style="border-radius:50%;">ãŸã¾ãƒ•ã‚£ãƒƒãƒˆPFC</h1>
</div>

<div class="container">
    <div class="top-alert-box" onclick="this.querySelector('.ta-list').style.display='block'">
        <span class="ta-title">ğŸ“¢ Ver 5.0 ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå®Œäº†ï¼ (ã‚¿ãƒƒãƒ—ã§è©³ç´°)</span>
        <div class="ta-list">
            ãƒ»ğŸ¥š AIãŸã¾ã¡ã‚ƒã‚“ã‚³ãƒ¼ãƒè¿½åŠ <br>
            ãƒ»ğŸ“‰ ä½“çµ„æˆãƒ»ã‚°ãƒ©ãƒ•ç®¡ç†è¿½åŠ <br>
            ãƒ»ğŸº é…’é£²ã¿ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
        </div>
        <div class="ta-warn">æ—§ãƒ‡ãƒ¼ã‚¿ã¯ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰å¾©å…ƒã—ã¦ãŸã¾ï¼</div>
        <button class="btn-import-huge" onclick="document.getElementById('imp-file-top').click()">ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ(ãŠå¼•è¶Šã—)</button>
        <input type="file" id="imp-file-top" style="display:none" onchange="importData(this)">
    </div>

    <div class="tgt-sec">
        <div class="tgt-tog" onclick="toggleTgt()">âš™ï¸ ç›®æ¨™: <span id="tgt-disp">è¨­å®šãªã—</span> â–¼</div>
        <div class="tgt-btns" id="tgt-btns"></div>
        <div id="cust-tgt">
            <div class="cust-row">
                <input type="text" inputmode="decimal" id="cust-cal" placeholder="Cal">
                <select id="pfc-mode">
                    <option value="std">æ¨™æº– (3:2:5)</option>
                    <option value="lowfat">ãƒ­ãƒ¼ãƒ•ã‚¡ãƒƒãƒˆ</option>
                    <option value="muscle">ç­‹è‚¥å¤§</option>
                    <option value="keto">ã‚±ãƒˆ</option>
                </select>
                <button class="cust-btn" onclick="applyCust()">è¨­å®š</button>
            </div>
            <div class="alc-toggle">
                <input type="checkbox" id="alc-mode-chk" onchange="toggleAlcMode()"> <label for="alc-mode-chk">ğŸº é…’é£²ã¿ãƒ¢ãƒ¼ãƒ‰</label>
            </div>
        </div>
    </div>
    
    <div class="dash">
        <div class="dash-t">TODAY'S TARGET <span id="pfc-ratio-disp"></span></div>
        <div class="mtr">
            <div class="mtr-l"><div class="lbl"><span>Cal</span><small>æ‘‚å–:<span id="cur-cal">0</span></small></div><span id="rem-cal" class="rem"></span></div>
            <div class="bar-bg"><div id="bar-cal" class="bar"></div><div id="bar-text-cal" class="bar-text"></div></div>
        </div>
        <div class="mtr">
            <div class="mtr-l"><div class="lbl"><span>P</span><small>æ‘‚å–:<span id="cur-p">0</span>g</small></div><span id="rem-p" class="rem"></span></div>
            <div class="bar-bg"><div id="bar-p" class="bar"></div><div id="bar-text-p" class="bar-text"></div></div>
        </div>
        <div class="mtr">
            <div class="mtr-l"><div class="lbl"><span>F</span><small>æ‘‚å–:<span id="cur-f">0</span>g</small></div><span id="rem-f" class="rem"></span></div>
            <div class="bar-bg"><div id="bar-f" class="bar"></div><div id="bar-text-f" class="bar-text"></div></div>
        </div>
        <div class="mtr">
            <div class="mtr-l"><div class="lbl"><span>C</span><small>æ‘‚å–:<span id="cur-c">0</span>g</small></div><span id="rem-c" class="rem"></span></div>
            <div class="bar-bg"><div id="bar-c" class="bar"></div><div id="bar-text-c" class="bar-text"></div></div>
        </div>
        <div class="mtr" id="mtr-a" style="display:none;">
            <div class="mtr-l"><div class="lbl"><span style="color:var(--alc)">Alcohol</span></div><span id="rem-a" class="rem" style="font-size:10px;">AÃ—7kcal</span></div>
            <div class="bar-bg"><div id="bar-a" class="bar"></div><div id="bar-text-a" class="bar-text"></div></div>
        </div>
    </div>
    
    <div class="inp-sec">
        <div class="s-box"><span class="s-icon">ğŸ”</span><input type="text" class="s-inp" id="s-inp" placeholder="é£Ÿå“ã‚’æ¤œç´¢..." oninput="filterF()"><div class="s-res" id="s-res"></div></div>
        <div class="cat-grp" id="cat-btns"></div>
        <div id="f-list"></div>
        <div id="amt-area">
            <div class="amt-btns rice" id="rice-btns" style="display:none;"></div>
            <div class="amt-btns" id="pst-btns"></div>
            <div id="pv-bar" class="pv-bar" style="display:none;" onclick="togBd()">
                <div id="pv-name" style="font-weight:700;color:var(--th);font-size:12px;"></div>
                <div id="pv-stat" style="font-size:11px;font-weight:700;"></div>
                <div style="font-size:9px;color:#bbb;text-align:right;">ğŸ–Šï¸ ã‚¿ãƒƒãƒ—ã§å¾®èª¿æ•´</div>
            </div>
            <div id="reg-bd" class="reg-bd">
                <div class="cls-bd" onclick="clsBd()">âœ•</div>
                <select id="m-time" style="width:100%; padding:6px; border-radius:6px; margin-bottom:8px; border:1px solid #ddd; font-size:12px;">
                    <option value="æœ">â˜€ï¸ æœ</option><option value="æ˜¼">â˜ï¸ æ˜¼</option><option value="æ™©">ğŸŒ™ æ™©</option><option value="é–“é£Ÿ">â˜• é–“é£Ÿ</option>
                </select>
                <input type="text" id="m-name" placeholder="é£Ÿå“å" style="font-size:12px; margin-bottom:8px;">
                <div class="m-grid">
                    <div><input type="text" inputmode="decimal" id="m-p" placeholder="P" oninput="calcM()"></div>
                    <div><input type="text" inputmode="decimal" id="m-f" placeholder="F" oninput="calcM()"></div>
                    <div><input type="text" inputmode="decimal" id="m-c" placeholder="C" oninput="calcM()"></div>
                    <div id="m-a-wrap" style="display:none;"><input type="text" inputmode="decimal" id="m-a" placeholder="A" oninput="calcM()"></div>
                </div>
                <div style="margin-top:8px; display:flex; gap:10px; align-items:center;">
                    <div style="flex:1;"><small>å€ç‡:</small><input type="text" inputmode="decimal" id="m-mul" value="1" style="text-align:center;" oninput="calcM()"></div>
                    <div style="flex:2;"><small>Cal:</small><input type="text" inputmode="decimal" id="m-cal" style="background:#f9f9f9;" oninput="calcM()"></div>
                </div>
                <button class="btn-my" onclick="regMyFood()" style="font-size:11px; padding:6px;">ğŸ’¾ Myé£Ÿå“ã«ç™»éŒ²</button>
            </div>
            <button id="btn-reg" class="btn-add" onclick="addM()">ãƒªã‚¹ãƒˆã«è¿½åŠ </button>
        </div>
    </div>
    
    <button class="my-manual-btn" onclick="openMan()">â–¼ æ‰‹å…¥åŠ›ãƒ»Myé£Ÿå“ç™»éŒ²</button>
    
    <div id="timeline-area" style="margin-top:15px;"></div>
    <div style="text-align:right; font-size:16px; margin-top:10px; font-weight:700;">TOTAL: <span id="tot-cal" style="color:var(--th);">0</span> <small>kcal</small></div>
    
    <div class="action-grid">
        <div class="action-tile t-copy" onclick="cpRes()"><div class="icon">ğŸ“‹</div><div class="label">ã‚³ãƒ”ãƒ¼</div></div>
        <div class="action-tile t-reset" onclick="rst()"><div class="icon">ğŸ”„</div><div class="label">ãƒªã‚»ãƒƒãƒˆ</div></div>
        <div class="action-tile t-hist" onclick="togHist()"><div class="icon">ğŸ“…</div><div class="label">å±¥æ­´</div></div>
        <div class="action-tile t-graph" onclick="togGraph()"><div class="icon">ğŸ“Š</div><div class="label">çµ±è¨ˆ</div></div>
        <div class="action-tile t-body" onclick="toggleBody()"><div class="icon">ğŸ“‰</div><div class="label">ä½“çµ„æˆ</div></div>
        <div class="action-tile t-form" onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSem4li3oXO5_JFqTUUk40dM_Zej4WInhDPilGAIFUzU97opGg/viewform?usp=publish-editor', '_blank')"><div class="icon">ğŸ“®</div><div class="label">è¦æœ›</div></div>
    </div>

    <div id="hist-area" class="expand-area"><div class="expand-close" onclick="this.parentElement.style.display='none'">âœ•</div><div id="h-list"></div></div>
    <div id="graph-area" class="expand-area graph-sec"><div class="expand-close" onclick="this.parentElement.style.display='none'">âœ•</div><div class="g-btns"><button class="g-btn act" onclick="drawGraph('week',this)">é€±é–“</button><button class="g-btn" onclick="drawGraph('month',this)">æœˆé–“</button></div><div id="chart-box" class="chart-box"></div><div id="stat-txt" class="stat-row"></div></div>
    <div id="body-content" class="expand-area body-sec"><div class="expand-close" onclick="this.parentElement.style.display='none'">âœ•</div><div class="b-toggle"><div class="b-tog-btn act" onclick="drawBodyGraph('A', this)">ãƒ¢ãƒ¼ãƒ‰A</div><div class="b-tog-btn" onclick="drawBodyGraph('B', this)">ãƒ¢ãƒ¼ãƒ‰B</div></div><div id="body-chart-area" class="body-graph-box"></div><div class="body-inp-grid"><div><input type="date" id="b-date"></div><div><input type="text" inputmode="decimal" id="b-weight" placeholder="kg"></div><div><input type="text" inputmode="decimal" id="b-fat" placeholder="%"></div></div><button class="btn-body-rec" onclick="saveBody()">è¨˜éŒ²</button><div id="body-hist-list" style="margin-top:10px;"></div></div>
</div>

<div id="reset-modal" class="modal-overlay"><div class="modal-box"><span class="modal-title">ä¿å­˜ã—ã¦ãƒªã‚»ãƒƒãƒˆï¼Ÿ</span><input type="date" id="reset-date" class="modal-date"><div class="modal-btns"><button class="m-btn m-cancel" onclick="closeResetModal()">Ã— No</button><button class="m-btn m-save" onclick="confirmReset()">OK</button></div></div></div>

<div id="global-mic-btn" onclick="startGlobalMic()">ğŸ™ï¸ éŸ³å£°ã§è¨˜éŒ²</div>

<div id="tama-chat-btn" onclick="toggleChat()"><img src="new_tama.png" alt="ãŸã¾ã¡ã‚ƒã‚“"></div>

<div id="tama-chat-window">
    <div class="chat-header"><span>ğŸ¥š ãŸã¾ã¡ã‚ƒã‚“ã‚³ãƒ¼ãƒ</span><span class="ch-close" onclick="toggleChat()">Ã—</span></div>
    <div class="chat-body" id="chat-messages"></div>
    <div class="chat-footer">
        <button id="mic-btn" onclick="toggleMic()">ğŸ¤</button>
        <input type="text" id="chat-input" placeholder="ãªã«ã‹å–‹ã£ã¦ãŸã¾ï¼">
        <button id="chat-send" onclick="sendTamaChat()">é€ä¿¡</button>
    </div>
</div>

<script src="database.js"></script>
<script src="tamachan-data.js"></script>
<script src="app.js"></script>
</body>
</html>
